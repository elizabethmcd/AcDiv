library(tidyverse)
library(reshape2)
library(viridis)

ani <- read.table("results/ANI/acc-ANI.txt") %>% select(V1,V2,V3)
colnames(ani) <- c("bin1", "bin2", "ANI")

clade_order <- c("UW4.fna",
                 "GCA_000585075.1.fna",
                 "GCA_002455435.1.fna",
                 "GCA_009467855.1.fna",
                 "UW3.fna",
                 'UW8-POB.fna',
                 "GCA_000585055.1.fna",
                 "GCA_002352265.1.fna",
                 "GCA_000987445.1.fna",
                 "GCA_003332265.1.fna",
                 "GCA_012939955.1",
                 "UW5.fna",
                 "GCA_000024165.1.fna",
                 'UW9-POB.fna',
                 "Fred_18-Q3-R57-64_MAXAC.027.fna",
                 "Hade_18-Q3-R52-61_BATAC.726.fna",
                 "OdNE_18-Q3-R46-58_BAT3C.415.fna",
                 'UW10-POB.fna',
                 "GCA_000585035.2.fna",
                 "GCA_000584955.2.fna",
                 "GCA_002425405.1.fna",
                 "GCA_005889575.1.fna",
                 "GCA_000987395.1.fna",
                 "GCA_000584975.2.fna",
                 "GCA_012940005.1",
                 "GCA_013414765.1",
                 "UW6.fna",
                 'UW11-POB.fna',
                 'UW12-POB.fna',
                 "EsbW_18-Q3-R4-48_BATAC.285.fna",
                 "GCA_000585095.1.fna",
                 "GCA_005524045.1.fna",
                 "UW7.fna",
                 "GCA_002433845.1.fna",
                 "GCA_000585015.1.fna",
                 "GCA_002345285.1.fna",
                 "GCA_003542235.1.fna",
                 "GCA_000584995.1.fna",
                 "GCA_003535635.1.fna",
                 "GCA_003487685.1.fna",
                 "GCA_002345025.1.fna",
                 'UW13-POB.fna',
                 "GCA_013347225.1",
                 "Fred_18-Q3-R57-64_BAT3C.720.fna",
                 'GCA_900089955.1.fna')

modf_order <- c('GCA_000585075.1.fna',
                'GCA_002455435.1.fna',
                'GCA_009467855.1.fna',
                'UW3.fna',
                'UW4.fna',
                'UW8-POB.fna',
                'GCA_000585055.1.fna',
                'GCA_000987445.1.fna',
                'GCA_002352265.1.fna',
                'GCA_003332265.1.fna',
                'GCA_012939955.1.fna',
                'GCA_000024165.1.fna',
                'UW5.fna',
                'UW9-POB.fna',
                'Fred_18-Q3-R57-64_MAXAC.027.fna',
                'Hade_18-Q3-R52-61_BATAC.726.fna',
                'OdNE_18-Q3-R46-58_BAT3C.415.fna',
                'UW10-POB.fna',
                'GCA_000584955.2.fna',
                'GCA_000584975.2.fna',
                'GCA_000585035.2.fna',
                'GCA_000987395.1.fna',
                'GCA_002425405.1.fna',
                'GCA_005889575.1.fna',
                'GCA_012940005.1.fna',
                'GCA_013414765.1.fna',
                'UW6.fna',
                'UW11-POB.fna',
                'EsbW_18-Q3-R4-48_BATAC.285.fna',
                'UW12-POB.fna',
                'GCA_000584995.1.fna',
                'GCA_000585015.1.fna',
                'GCA_000585095.1.fna',
                'GCA_002345025.1.fna',
                'GCA_002345285.1.fna',
                'GCA_002433845.1.fna',
                'GCA_003487685.1.fna',
                'GCA_003535635.1.fna',
                'GCA_003542235.1.fna',
                'GCA_005524045.1.fna',
                'GCA_013347225.1.fna',
                'UW7.fna',
                'UW13-POB.fna',
                'Fred_18-Q3-R57-64_BAT3C.720.fna',
                'GCA_900089955.1.fna')

keep <- ani %>% filter(bin1 !="GCA_001897745.1" & bin1 != "GCA_002304785.1" & bin1 != "GCA_003538495.1" & bin1 != "GCA_013822655.1" & bin1 != "GCA_013823155.1" & bin2 !="GCA_001897745.1" & bin2 != "GCA_002304785.1" & bin2 != "GCA_003538495.1" & bin2 != "GCA_013822655.1" & bin2 != "GCA_013823155.1")

keep$bin1 <- factor(keep$bin1, levels=c(clade_order))
keep$bin2 <- factor(keep$bin2, levels=c(clade_order))

ani_heatmap <- keep %>% ggplot(aes(x=bin1, y=bin2, fill=ANI)) + geom_raster() + scale_fill_viridis(option="inferno") + theme(axis.text.x= element_text(angle=85, hjust=1))

ani_heatmap
